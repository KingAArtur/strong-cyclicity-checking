\section{Свойства циклических векторов}

Рассматривается усеченная дифференциальная система \eqref{system} с~матрицей~$A$ размера~$m \times m$,
$v$ "--- вектор размера~$m$.


\begin{proposition}
    $\dett\diffMatrix$ имеет вид многочлена от $x$.
\end{proposition}

\begin{proof}
    Несложно показать, что в~результате сложения, перемножения многочленов и взятия производной от~многочлена
    в~результате получается многочлен.
    
    Элементами вектора~$v$ и матрицы~$A$ являются многочлены,
    это значит, что все элементы матрицы \diffMatrix\ производных вектора~$v$ в силу системы
    будут являться многочленами, поскольку они получаются в~результате применения
    операции дифференцирования вектора в~силу системы \eqref{differention},
    состоящей, в~свою очередь, из~операций умножения, взятия производной и сложения.
    
    В силу свойств определителя $\dett\diffMatrix$ будет также являться многочленом от~$x$.
\end{proof}


\begin{proposition}
    Пусть к~матрице~$A$ была применена операция одноэлементного продолжения:
    $B = A + cx^t \cdot I_{ij}$, где $c$ "--- символьный коэффициент.
    
    Тогда $\dett\diffMatrix[B]$ имеет вид многочлена от~двух переменных $p(x, c)$,
    который можно рассматривать как многочлен от~$x$, коэффициенты которого "--- многочлены от~$c$.
\end{proposition}

\begin{proof}
    Доказательство повторяет доказательство предыдущего утверждения с~той поправкой,
    что теперь элементы вектора~$v$ и матрицы~$B$ стоит рассматривать как многочлены от~двух переменных $x$ и $c$.
\end{proof}

В дальнейшем нам будет удобно рассматривать $\dett\diffMatrix[B]$
именно как многочлен от переменной $x$, коэффииентами которого являются многочлены от~$c$.


\begin{proposition}
Пусть $d$ "--- степень усечения системы \eqref{system}, v "--- циклический вектор. Тогда, если
\begin{equation}
	d + 3 - m > \val(\dett\diffMatrix),
	\label{d3m}
\end{equation}
то $v$ "--- сильно циклический.

\end{proposition}

\begin{proof}

Идея доказательства заключается в следующем.
Покажем, что никакое одноэлементное продолжение~$B$ матрицы~$A$ не нарушит цикличность вектора~$v$.
Рассмотрим произвольное продолжение элемента матрицы~$a_{ij}$ с~некоторой степенью $t > d: b_{ij} = a_{ij} + cx^t$,
где $c$ "--- символьный коэффициент; остальные элементы матриц совпадают.
По заданной матрице~$B$ построим матрицу~\diffMatrix[B] и выясним, равен ли ее определитель нулю.
$\dett \diffMatrix[B]$ будет являться многочленом от~$x$, коэффициенты которого являются многочленами от~$c$.
Покажем, что при выполнении~\eqref{d3m} \textit{трейлинговый коэффициент} $\tc (\dett \diffMatrix[B])$ будет равен $\tc (\dett \diffMatrix)$
(а значит, он не~будет равным нулю).
Из этого будет следовать, что и сам определитель не~будет равен нулю, а это, как указано в~\eqref{diffMatrixNotZero}, означает, что вектор~$v$ является циклическим для~данного продолжения.
\medskip

Перейдем теперь непосредственно к~доказательству.

Запишем одноэлементное продолжение матрицы следующим образом:
\begin{equation}
	B = A + cx^t \cdot I_{ij},
\end{equation}
где~$c$ "--- символьный коэффициент.

Элементы матрицы~\diffMatrix[B] устроены следующим образом.
Они отличаются от~элементов \diffMatrix\ наличием слагаемых, имеющих вид многочленов от~$x$, все коэффициенты которых зависят от~$c$.
В частности, при $c = 0$ матрица производных~\diffMatrix[B] будет совпадать с~\diffMatrix.
Аналогичное можно сказать и про~$\dett \diffMatrix[B]$: он будет отличаться от~$\dett \diffMatrix$ 
лишь наличием некоторого количества слагаемых с~символьным коэффициентом~$c$ при~некоторых степенях~$x$.
\medskip

Рассмотрим матрицу \diffMatrix[B] более подробно.
Попробуем понять, при~каких степенях переменной~$x$ может присутствовать символьный коэффициент~$c$.
Рассматривать матрицу будем по~столбцам, исходя из~представления~\eqref{diffMatrix}.

Первый столбец матрицы \diffMatrix[B] равен~$v$, а значит, он будет равен первому столбцу \diffMatrix\ и не~будет содержать~$c$.

Второй столбец матрицы \diffMatrix[B] по~формуле~\eqref{differention} равен $v_2 = v' + {B}^Tv$.
Поскольку в этой конструкции коэффициент~$c$ 
содержится только в~матрице~${B}^T$, в столбце он может появится только в одной позиции "--- под номером~$j$.
Появляется он как результат умножения элемента матрицы $B^{T}_{ji}$,
содержащего слагаемое~$cx^t$, на~некоторый элемент вектора~$v$.
Степень переменной~$x$ при~этом символьном коэффициенте~$c$
будет не~меньше~$t$. Символично обозначим это следующим образом:

\begin{equation*}
    \bordermatrix{
		&           & 2       &        \cr
		&   -       & -       & \cdots \cr
		&   \vdots  & \vdots  & \ddots \cr
		j & -       & t       & \cdots \cr
		&   \vdots  & \vdots  & \ddots \cr
		&   -       & -       & \cdots \cr
	}
\end{equation*}

Третий столбец матрицы равен $v_2' + {B}^Tv_2$, где $v_2$ -- предыдущий столбец матрицы \diffMatrix[B], $j$-я компонента которого может содержать коэффициент~$c$,
причем степень переменной~$x$ при нем не меньше~$t$.
Теперь уже во~всех элементах столбца может содержаться коэффициент~$c$, причем во~всех его компонентах (кроме $j$-й) степень~$x$ при нем будет не~меньше~$t$.
Появляется он как результат умножения элемента вектора~${v_2}_j$ на~$j$-й столбец матрицы~$B^T$.
В~$j$-м~же компоненте столбца минимально возможная степень~$x$ при~коэффициенте~$c$ будет на~единицу меньше благодаря покомпонентному дифференцированию вектора~$v_2$.
Символично обозначим это следующим образом:

\begin{equation*}
    \bordermatrix{
		&           &         & 3      &        \cr
		&   -       & -       & t      & \cdots \cr
		&   \vdots  & \vdots  & \vdots & \ddots \cr
		j & -       & t       & t - 1  & \cdots \cr
		&   \vdots  & \vdots  & \vdots & \ddots \cr
		&   -       & -       & t      & \cdots \cr
	}
\end{equation*}

В следующих столбцах минимальная степень~$x$ будет продолжать уменьшаться на~единицу благодаря покомпонентному дифференцированию предыдущего столбца.

Получаем следующие минимально возможные степени~$x$ при символьном коэффициенте~$c$ в матрице~\diffMatrix[B]:

\begin{equation*}
    \bordermatrix{
		&           &         &        &        &        &           \cr
		&   -       & -       & t      & t - 1  & \cdots & t + 3 - m \cr
		&   \vdots  & \vdots  & \vdots & \vdots & \ddots & \vdots    \cr
		j & -       & t       & t - 1  & t - 2  & \cdots & \mathbf{t + 2 - m} \cr
		&   \vdots  & \vdots  & \vdots & \vdots & \ddots & \vdots    \cr
		&   -       & -       & t      & t - 1  & \cdots & t + 3 - m \cr
	}
\end{equation*}

Таким образом, $t + 2 - m$ "--- минимальная степень~$x$, при которой в матрице~\diffMatrix[B] может находиться коэффициент~$c$.
Это значит, что и в определителе $\dett \diffMatrix[B]$ коэффициент~$c$ может находиться при степени~$x$ не~меньше $t + 2 - m$.

Заметим, что в~исходном определителе $\dett\diffMatrix$ коэффициент при~степени~$x^{\val(\dett\diffMatrix)}$ не~равен нулю,
потому что это трейлинговый коэффициент.
Данное слагаемое присутствует также в определителе~$\dett\diffMatrix[B]$. Запишем определитель в~следующем виде:
\begin{equation}
	\dett\diffMatrix[B] = \underbrace{b \cdot x ^ {\val(\dett\diffMatrix)} + \dots}_{\text{слагаемые без $c$}} + \underbrace{f(c) \cdot x ^ {t + 2 - m} + \dots}_{\text{слагаемые с $c$}},
\end{equation}
где~$b$ "--- некоторая ненулевая константа, не~зависящая от~$c$.

Заметим, что если $t + 2 - m$ окажется больше $\val(\dett\diffMatrix)$, то в~коэффициент при~степени~$x^{\val(\dett\diffMatrix)}$ не~войдет коэффициент~$c$.
Значит, $\dett\diffMatrix[B]$ останется не~равным нулю при любых значениях~$c$.

Поскольку $t \ge d + 1$, получаем, что при $d + 1 > m - 2 + \val(\dett\diffMatrix)$ никакое одноэлементное продолжение матрицы~$A$ не~может нарушить цикличность вектора~$v$.
Следовательно, при выполнении условия~\eqref{d3m} вектор~$v$ является сильно циклическим.
\end{proof}

Непосредственно из доказанного утверждения вытекает
\begin{consequence}
    Никакое одноэлементное продолжение~$B$ матрицы~$A$ со степенью выше $\val(\dett\diffMatrix)+m-3$ не~может обратить в нуль $\dett \diffMatrix[B]$.
\end{consequence}


\begin{example}
    Пусть
	\begin{equation*}
		A = 
		\begin{pmatrix}
			1 - x & x & 1 \\
			1 - x & 1 & 1 + x \\
			-1 - x & -1 & 1 - x \\
		\end{pmatrix},
		v =
		\begin{pmatrix}
			0 \\
			1 \\
			0 \\
		\end{pmatrix}.
	\end{equation*}
    
    Имеем $m = 3$, $d = 1$ (максимальная степень элементов матрицы).
    
    Определитель $\dett\diffMatrix$ равен $-4 - x - 4x^2 - x^3$,
    валюация $\val(\dett\diffMatrix)$ равна 0.
    
	Неравенство \eqref{d3m} выполнено, из чего следует, что вектор $v$ "--- сильно циклический для системы с~матрицей~$A$.
\end{example}


\begin{proposition}
Пусть $p(x)$ "--- некоторый многочлен. Тогда
\begin{equation*}
    \dett[\Delta_A p(x)v] = p^{m}(x)\dett[\Delta_A v].
\end{equation*}
\end{proposition}

\begin{proof}

Обозначим столбцы матрицы $[\Delta_A v]$ как $v_i$, а столбцы $[\Delta_A p(x)v]$ "--- как $w_i$ ($i = 0, \dots, m - 1$):
\begin{equation*}
    [\Delta_A v] = [v_0 \mid v_1 \mid v_2 \mid \dots \mid v_{m-1}]
\end{equation*}
\begin{equation*}
    [\Delta_A p(x)v] = [w_0 \mid w_1 \mid w_2 \mid \dots \mid w_{m-1}]
\end{equation*}

При этом $v_0 \equiv v$, $w_0 \equiv p \cdot v_0$, $v_{i+1} = v_{i}' + A^T v_{i}$, $w_{i+1} = w_{i}' + A^T w_{i}$.

Докажем, что каждый столбец $w_i$ можно представить в виде
линейной комбинации столбцов $v_0, \dots, v_i$:
\begin{equation*}
    w_i = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_k,
\end{equation*}
где $c_{ik}$ "--- некоторые константы, $p^{(n)}$ "--- $n$-я производная многочлена~$p(x)$ ($p^{(0)} \equiv p$).

Доказательство проведем по индукции.

\emph{База индукции.} $i = 0$: $w_0 = p \cdot v_0 = 1 \cdot p^{(0)} \cdot v_0$ "--- верно.

\emph{Предположение индукции.} Пусть верно для номера~$i$:
\begin{equation*}
    w_i = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_k.
\end{equation*}

\emph{Шаг индукции.} Докажем, что верно и для номера~$i + 1$, т.е.
\begin{equation*}
    w_{i+1} = \sum\limits_{k = 0}^{i+1} c_{i+1, k} \cdot p^{(i + 1 - k)} v_k.
\end{equation*}

\begin{equation*}
    w_{i+1} = w_{i}' + A^T w_{i} = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i + 1 - k)} v_k +
    \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_k' + A^T \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_k =
\end{equation*}

\begin{equation*}
    = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i + 1 - k)} v_k +
    \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_k' + \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} A^T v_k =
\end{equation*}

\begin{equation*}
    = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i + 1 - k)} v_k +
    \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} (v_k' + A^T v_k) =
\end{equation*}

\begin{equation*}
    = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i + 1 - k)} v_k +
    \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_{k+1} =
\end{equation*}

\begin{equation*}
    = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i + 1 - k)} v_k +
    \sum\limits_{k = 1}^{i + 1} c_{i,k-1} \cdot p^{(i + 1 - k)} v_{k} =
    \sum\limits_{k = 0}^{i + 1} c_{i + 1,k} \cdot p^{(i + 1 - k)} v_k,
\end{equation*}

где $c_{i + 1,k} = c_{i,k} + c_{i,k - 1} (k = 1, \dots, i), c_{i+1,0} = c_{i,0}, c_{i+1,i+1} = c_{i,i}$.

Таким образом, мы доказали, что
\begin{equation*}
    w_i = \sum\limits_{k = 0}^i c_{ik} \cdot p^{(i - k)} v_k.
\end{equation*}

Проведем над~матрицей~$[\Delta_A p(x)v]$ следующие преобразования, не~меняющие ее определитель:
из~каждого столбца $w_{i}$ ($i = 1, \dots, m - 1$) последовательно вычтем столбцы с~номерами $k = 0, \dots, i - 1$,
умноженные на~$\frac{c_{ik} \cdot p^{(i - k)}}{p}$.

После указанных преобразований матрица $[\Delta_A p(x)v]$ примет вид
\begin{equation*}
    [\Delta_A p(x)v] = [p \cdot v_0 \mid p \cdot v_1 \mid p \cdot v_2 \mid \dots \mid p \cdot v_{m-1}].
\end{equation*}

Данная матрица отличается от~$[\Delta_A v]$ лишь тем, что каждый ее столбец дополнительно умножен на~$p(x)$.
После вынесения из каждого столбца множителя $p(x)$ за знак определителя получим искомое равенство.

\end{proof}

\begin{consequence}
Вектор~$v$ является циклическим тогда и только тогда, когда $x v$ является циклическим.
\end{consequence}

\begin{proof}
Если $\dett[\Delta_A v] \neq 0$, то и $\dett[\Delta_A xv] = x^{m}\dett[\Delta_A v] \neq 0$.
\end{proof}